<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Swift Tutorial</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


a:link { color:navy; }
a:visited { color:navy; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: medium; /* inherit; */
  color: black;
  padding: 0;
  margin: 0;
}

/*
  background: #f8f8f8;
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  margin-right: 10%;
*/

div.listingblock > div.content {
  padding: 0.5em;
  background: none;
  border: none;
  border-left: none;
  margin-right: none;
}

</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article" style="max-width:800px">
<div id="header">
<h1>Swift Tutorial</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>This tutorial is viewable at:</p></div>
<div class="paragraph"><p>[red]#TODO&gt; <a href="http://swiftlang.org/tutorials/swift-tutorial-0.96">http://swiftlang.org/tutorials/swift-tutorial-0.96</a></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_why_parallel_scripting">Introduction: Why Parallel Scripting?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Swift is a simple scripting language for executing many instances of
ordinary application programs on distributed and parallel resources.
Swift scripts run many copies of ordinary programs concurrently, using
statements like this:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>foreach protein <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> proteinList <span style="color: #990000">{</span>
  <span style="font-weight: bold"><span style="color: #000000">runBLAST</span></span><span style="color: #990000">(</span>protein<span style="color: #990000">);</span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Swift acts like a structured "shell" language. It runs programs concurrently as
soon as their inputs are available, reducing the need for complex parallel
programming.  Swift expresses workflow in a portable fashion: The same script
can run on multicore computers, clusters, clouds, grids, and supercomputers.</p></div>
<div class="paragraph"><p>In this tutorial, you will be able to first try a few Swift examples (examples
1-3) on your local machine, to get a sense of the language.  Then, in examples
4-6 you will run similar workflows on any resource you may have access to, such
as clouds (Amazon Web Services), Cray HPC systems, clusters etc, and see how
more complex workflows can be expressed with Swift scripts.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_tutorial">Running the tutorial</h2>
<div class="sectionbody">
<div class="paragraph"><p>To run the tutorial, ensure that (Oracle/Sun) java (1.7+) and swift-0.96 is
installed on the machine you would be using to run the tutorial on.</p></div>
<div class="paragraph"><p>Swift is available as loadable software module on Beagle, Midway and
OSGConnect. If a module is not available the following steps describe the
installation procedure.</p></div>
<div class="paragraph"><p><span class="red">TODO: Ensure latest modules are available on Beagle/Midway/OSGConnect</span></p></div>
<div class="sect2">
<h3 id="_swift_installation">Swift installation</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Download the swift-0.96 package</span></span>
wget http<span style="color: #990000">:</span>//swiftlang<span style="color: #990000">.</span>org/packages/swift-<span style="color: #993399">0.96</span><span style="color: #990000">.</span>tar<span style="color: #990000">.</span>gz

<span style="font-style: italic"><span style="color: #9A1900"># Extract package</span></span>
tar xfz swift-<span style="color: #993399">0.96</span><span style="color: #990000">.</span>tar<span style="color: #990000">.</span>gz

<span style="font-style: italic"><span style="color: #9A1900"># Add swift to the PATH environment variable</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">export</span></span> <span style="color: #009900">PATH</span><span style="color: #990000">=</span><span style="color: #009900">$PATH</span><span style="color: #990000">:</span>/path/to/swift-<span style="color: #993399">0.96</span>/bin

<span style="font-style: italic"><span style="color: #9A1900"># To verify that Swift has successfully loaded, run:</span></span>
$ swift -version
<span style="font-style: italic"><span style="color: #9A1900"># This should print Swift 0.96</span></span></tt></pre></div></div>
</div>
<div class="sect2">
<h3 id="_setup_the_swift_tutorial">Setup the swift-tutorial</h3>
<div class="paragraph"><p>Clone the repository from github</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>git clone https<span style="color: #990000">:</span>//github<span style="color: #990000">.</span>com/swift-lang/swift-tutorial<span style="color: #990000">.</span>git
cd swift-tutorial</tt></pre></div></div>
<div class="paragraph"><p>Or, download the zip file from github and unpack.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Download</span></span>
wget https<span style="color: #990000">:</span>//github<span style="color: #990000">.</span>com/swift-lang/swift-tutorial/archive/master<span style="color: #990000">.</span>zip
unzip master<span style="color: #990000">.</span>zip
mv swift-tutorial-master swift-tutorial
cd swift-tutorial</tt></pre></div></div>
<div class="paragraph"><p>Now, run the tutorial setup script:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">source</span></span> setup<span style="color: #990000">.</span>sh  <span style="font-style: italic"><span style="color: #9A1900"># You must run this with "source" !</span></span></tt></pre></div></div>
<div class="paragraph"><p>Doing this will add the sample applications <code>simulate</code> and <code>stats</code>
(explained in the next part) and some other functionalities to
your local $PATH for you to run the tutorial.</p></div>
<div class="paragraph"><p>Note: We will come back to Swift configuration using the <code>swift.conf</code> file
in part4-6 to enable remote sites for computation.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_strong_tutorial_section_one_strong"><strong>Tutorial Section One</strong></h2>
<div class="sectionbody">
<div class="paragraph"><p>This section will be a walk-through of the getting a simple "mock" science application
running with swift on your local machine (localhost).</p></div>
<div class="sect2">
<h3 id="_example_1_run_a_single_application_under_swift">Example 1: Run a single application under Swift</h3>
<div class="paragraph"><p>The first swift script, p1.swift, runs simulate.sh to generate a
single random number. It writes the number to a file.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="part01.png" alt="p1 workflow" />
</div>
</div>
<div class="listingblock">
<div class="title">p1.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file o<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">()</span>
<span style="color: #990000">{</span>
  simulate stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>o<span style="color: #990000">);</span>
<span style="color: #990000">}</span>

file f <span style="color: #990000">&lt;</span><span style="color: #FF0000">"sim.out"</span><span style="color: #990000">&gt;;</span>
f <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">();</span></tt></pre></div></div>
<div class="paragraph"><p>[red]#TODO: Update the following output block</p></div>
<div class="paragraph"><p>To run this script, run the following command:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">01</span>
$ swift p1<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">21</span><span style="color: #990000">:</span><span style="color: #993399">51</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">21</span><span style="color: #990000">:</span><span style="color: #993399">52</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">1</span>
Final status<span style="color: #990000">:</span>Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">22</span><span style="color: #990000">:</span><span style="color: #993399">11</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">1</span>

$ cat sim<span style="color: #990000">.</span>out
      <span style="color: #993399">18</span></tt></pre></div></div>
<div class="paragraph"><p>To cleanup the directory and remove all outputs (including the log
files and directories that Swift generates), run the cleanup script
which is located in the tutorial PATH:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cleanup</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">You will also find a Swift configuration file in each <code>partNN</code> directory
of this tutorial. This specify the environment-specific details of target
computational resource where the application programs would be executed.  This
swift configuration file will be explained in more detail in parts 4-6, and can
be ignored for now.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_example_2_running_an_ensemble_of_many_apps_in_parallel_with_a_foreach_loop">Example 2: Running an ensemble of many apps in parallel with a "foreach" loop</h3>
<div class="paragraph"><p>The <code>p2.swift</code> script introduces the <code>foreach</code> parallel iteration construct to run many concurrent simulations.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="part02.png" alt="part02.png" />
</div>
</div>
<div class="listingblock">
<div class="title">p2.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file o<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">()</span>
<span style="color: #990000">{</span>
  simulate stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>o<span style="color: #990000">);</span>
<span style="color: #990000">}</span>

foreach i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">:</span><span style="color: #993399">9</span><span style="color: #990000">]</span> <span style="color: #990000">{</span>
  file f <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".out"</span><span style="color: #990000">)&gt;;</span>
  f <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">();</span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="paragraph"><p>The script also shows an example of naming the output files of an ensemble run. In this case,
the output files will be named
<code>output/sim_N.out</code>.</p></div>
<div class="paragraph"><p>To run the script and view the output:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">02</span>
$ swift p2<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">24</span><span style="color: #990000">:</span><span style="color: #993399">07</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">24</span><span style="color: #990000">:</span><span style="color: #993399">08</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">10</span>
Final status<span style="color: #990000">:</span>Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">24</span><span style="color: #990000">:</span><span style="color: #993399">27</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">10</span>

$ ls output<span style="color: #990000">/</span>
sim_0<span style="color: #990000">.</span>out  sim_1<span style="color: #990000">.</span>out  sim_2<span style="color: #990000">.</span>out  sim_3<span style="color: #990000">.</span>out  sim_4<span style="color: #990000">.</span>out  sim_5<span style="color: #990000">.</span>out  sim_6<span style="color: #990000">.</span>out  sim_7<span style="color: #990000">.</span>out  sim_8<span style="color: #990000">.</span>out  sim_9<span style="color: #990000">.</span>out

$ cat output/sim_1<span style="color: #990000">.</span>out
      <span style="color: #993399">13</span>

$ cat output/sim_2<span style="color: #990000">.</span>out
       <span style="color: #993399">4</span></tt></pre></div></div>
</div>
<div class="sect2">
<h3 id="_example_3_analyzing_results_of_a_parallel_ensemble">Example 3: Analyzing results of a parallel ensemble</h3>
<div class="paragraph"><p>After all the parallel simulations in an ensemble run have completed,
it is typically necessary to gather and analyze their results with some
kind of post-processing analysis program or script.  p3.swift
introduces such a postprocessing step. In this case, the files created
by all of the parallel runs of <code>simulation.sh</code> will be averaged by
the trivial "analysis application" <code>stats.sh</code>:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="part03.png" alt="part03.png" />
</div>
</div>
<div class="listingblock">
<div class="title">p3.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file o<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">(</span>int sim_steps<span style="color: #990000">,</span> int sim_range<span style="color: #990000">,</span> int sim_values<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  simulate <span style="color: #FF0000">"--timesteps"</span> sim_steps <span style="color: #FF0000">"--range"</span> sim_range <span style="color: #FF0000">"--nvalues"</span> sim_values stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>o<span style="color: #990000">);</span>
<span style="color: #990000">}</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file o<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span> <span style="color: #990000">(</span>file s<span style="color: #990000">[])</span>
<span style="color: #990000">{</span>
  stats <span style="font-weight: bold"><span style="color: #000000">filenames</span></span><span style="color: #990000">(</span>s<span style="color: #990000">)</span> stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>o<span style="color: #990000">);</span>
<span style="color: #990000">}</span>

int nsim   <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"nsim"</span><span style="color: #990000">,</span><span style="color: #FF0000">"10"</span><span style="color: #990000">));</span>
int steps  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"steps"</span><span style="color: #990000">,</span><span style="color: #FF0000">"1"</span><span style="color: #990000">));</span>
int range  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"range"</span><span style="color: #990000">,</span><span style="color: #FF0000">"100"</span><span style="color: #990000">));</span>
int values <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"values"</span><span style="color: #990000">,</span><span style="color: #FF0000">"5"</span><span style="color: #990000">));</span>

file sims<span style="color: #990000">[];</span>

foreach i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">:</span>nsim<span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">]</span> <span style="color: #990000">{</span>
  file simout <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".out"</span><span style="color: #990000">)&gt;;</span>
  simout <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">(</span>steps<span style="color: #990000">,</span>range<span style="color: #990000">,</span>values<span style="color: #990000">);</span>
  sims<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> simout<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

file stats<span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/average.out"</span><span style="color: #990000">&gt;;</span>
stats <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span><span style="color: #990000">(</span>sims<span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>To run:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">03</span>
$ swift p3<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">27</span><span style="color: #990000">:</span><span style="color: #993399">23</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">27</span><span style="color: #990000">:</span><span style="color: #993399">24</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">10</span>
Final status<span style="color: #990000">:</span>Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">27</span><span style="color: #990000">:</span><span style="color: #993399">44</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">11</span>

$ ls output<span style="color: #990000">/</span>
average<span style="color: #990000">.</span>out  sim_0<span style="color: #990000">.</span>out  sim_1<span style="color: #990000">.</span>out  sim_2<span style="color: #990000">.</span>out  sim_3<span style="color: #990000">.</span>out  sim_4<span style="color: #990000">.</span>out  sim_5<span style="color: #990000">.</span>out  sim_6<span style="color: #990000">.</span>out  sim_7<span style="color: #990000">.</span>out  sim_8<span style="color: #990000">.</span>out  sim_9<span style="color: #990000">.</span>out

$ cat output/average<span style="color: #990000">.</span>out
<span style="color: #993399">52</span></tt></pre></div></div>
<div class="paragraph"><p>Note that in <code>p3.swift</code> we expose more of the capabilities of the
<code>simulate.sh</code> application to the <code>simulation()</code> app function:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file o<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">(</span>int sim_steps<span style="color: #990000">,</span> int sim_range<span style="color: #990000">,</span> int sim_values<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  simulate <span style="color: #FF0000">"--timesteps"</span> sim_steps <span style="color: #FF0000">"--range"</span> sim_range <span style="color: #FF0000">"--nvalues"</span> sim_values stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>o<span style="color: #990000">);</span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="paragraph"><p><code>p3.swift</code> also shows how to fetch application-specific values from
the <code>swift</code> command line in a Swift script using <code>arg()</code> which
accepts a keyword-style argument and its default value:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>int nsim   <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"nsim"</span><span style="color: #990000">,</span><span style="color: #FF0000">"10"</span><span style="color: #990000">));</span>
int steps  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"steps"</span><span style="color: #990000">,</span><span style="color: #FF0000">"1"</span><span style="color: #990000">));</span>
int range  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"range"</span><span style="color: #990000">,</span><span style="color: #FF0000">"100"</span><span style="color: #990000">));</span>
int values <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"values"</span><span style="color: #990000">,</span><span style="color: #FF0000">"5"</span><span style="color: #990000">));</span></tt></pre></div></div>
<div class="paragraph"><p>Now we can specify that more runs should be performed and that each should run for more
timesteps, and produce more that one value each, within a specified range, using command line
arguments placed after the Swift script name in the form <code>-parameterName=value</code>:</p></div>
<div class="paragraph"><p>Now try running (<code>-nsim=</code>) 100 simulations of (<code>-steps=</code>) 1 second each:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ swift p3<span style="color: #990000">.</span>swift -nsim<span style="color: #990000">=</span><span style="color: #993399">100</span> -steps<span style="color: #990000">=</span><span style="color: #993399">1</span>
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run002
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">29</span><span style="color: #990000">:</span><span style="color: #993399">45</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">29</span><span style="color: #990000">:</span><span style="color: #993399">46</span>-<span style="color: #993399">0600</span>  Selecting site<span style="color: #990000">:</span><span style="color: #993399">80</span>  Active<span style="color: #990000">:</span><span style="color: #993399">20</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">07</span>-<span style="color: #993399">0600</span>  Selecting site<span style="color: #990000">:</span><span style="color: #993399">60</span>  Active<span style="color: #990000">:</span><span style="color: #993399">20</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">20</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">28</span>-<span style="color: #993399">0600</span>  Selecting site<span style="color: #990000">:</span><span style="color: #993399">40</span>  Active<span style="color: #990000">:</span><span style="color: #993399">20</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">40</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">49</span>-<span style="color: #993399">0600</span>  Selecting site<span style="color: #990000">:</span><span style="color: #993399">20</span>  Active<span style="color: #990000">:</span><span style="color: #993399">20</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">60</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">10</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">20</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">80</span>
Final status<span style="color: #990000">:</span>Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">31</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">101</span></tt></pre></div></div>
<div class="paragraph"><p>We can see from Swift&#8217;s "progress" status that the tutorial&#8217;s default
<code>swift.conf</code> parameters for local execution allow Swift to run up to 20
application invocations concurrently on the login node. We will look at
this in more detail in the next sections where we execute applications
on the site&#8217;s compute nodes.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_strong_tutorial_section_two_strong"><strong>Tutorial Section Two</strong></h2>
<div class="sectionbody">
<div class="paragraph"><p>This section introduces the aspects of running on remote computational resources.
We will go into the configuration aspects that allow swift to run your applications
on computation resources. The <code>swift.conf</code> file contains definitions of various aspects
of different remote computational resources that swift can run your tasks on.</p></div>
<div class="paragraph"><p>The examples 4-6, are designed to run on remote sites, and require configurations to be set in
the <code>swift.conf</code>. There are 6 remote sites defined in the swift.conf:</p></div>
<div class="ulist"><ul>
<li>
<p>
Beagle
</p>
</li>
<li>
<p>
Blues
</p>
</li>
<li>
<p>
Midway
</p>
</li>
<li>
<p>
OSGConnect
</p>
</li>
<li>
<p>
Amazon EC2
</p>
</li>
<li>
<p>
Collection of Ad-hoc nodes (ad-hoc-1..N).
</p>
</li>
</ul></div>
<div class="paragraph"><p>To configure the remote site definition for a particular site, open the swift-tutorial/swift.conf file
and edit the site entry for that site. For example, if you like to run the tutorial on the Midway
cluster, edit the site.midway entry in the swift-tutorial/swift.conf file and follow the instructions
given for midway in the config file.</p></div>
<div class="paragraph"><p>Here is a snippet from the swift.conf for the midway cluster:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># Instructions for Midway:</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># 1. If you are running on the midway login nodes you set jobManager: "local:slurm"</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># 2. Set workDirectory to /tmp/your_username_on_midway</span></span>
site<span style="color: #990000">.</span>midway <span style="color: #990000">{</span>
    execution <span style="color: #990000">{</span>
        type      <span style="color: #990000">:</span> <span style="color: #FF0000">"coaster"</span>                         <span style="font-style: italic"><span style="color: #9A1900"># Use coasters to run on remote sites</span></span>
        URL       <span style="color: #990000">:</span> <span style="color: #FF0000">"midway.rcc.uchicago.edu"</span>         <span style="font-style: italic"><span style="color: #9A1900"># Midway login node</span></span>
        jobManager<span style="color: #990000">:</span> <span style="color: #FF0000">"ssh-cl:slurm"</span>                    <span style="font-style: italic"><span style="color: #9A1900"># Use ssh-cl to connect, slurm is the Local resource manager</span></span>
        options <span style="color: #990000">{</span>
            maxJobs         <span style="color: #990000">:</span> <span style="color: #993399">1</span>                       <span style="font-style: italic"><span style="color: #9A1900"># Max jobs submitted to LRM</span></span>
            nodeGranularity <span style="color: #990000">:</span> <span style="color: #993399">1</span>                       <span style="font-style: italic"><span style="color: #9A1900"># Nodes per job</span></span>
            maxNodesPerJob  <span style="color: #990000">:</span> <span style="color: #993399">1</span>                       <span style="font-style: italic"><span style="color: #9A1900"># Nodes per job</span></span>
            tasksPerNode    <span style="color: #990000">:</span> <span style="color: #993399">1</span>                       <span style="font-style: italic"><span style="color: #9A1900"># Tasks per Node</span></span>
            jobQueue        <span style="color: #990000">:</span> <span style="color: #FF0000">"sandyb"</span>                <span style="font-style: italic"><span style="color: #9A1900"># Select queue from (sandyb, westmere, ...)</span></span>
            maxJobTime      <span style="color: #990000">:</span> <span style="color: #FF0000">"00:25:00"</span>              <span style="font-style: italic"><span style="color: #9A1900"># Time requested per job</span></span>
        <span style="color: #990000">}</span>
    <span style="color: #990000">}</span>
    staging             <span style="color: #990000">:</span> <span style="color: #FF0000">"local"</span>                     <span style="font-style: italic"><span style="color: #9A1900"># Stage files from "local" system to Midway</span></span>
    workDirectory       <span style="color: #990000">:</span> <span style="color: #FF0000">"/tmp/"</span>$<span style="color: #990000">{</span>env<span style="color: #990000">.</span>MIDWAY_USERNAME<span style="color: #990000">}</span> <span style="font-style: italic"><span style="color: #9A1900"># Location for intermediate files</span></span>
    maxParallelTasks    <span style="color: #990000">:</span> <span style="color: #993399">101</span>                         <span style="font-style: italic"><span style="color: #9A1900"># Maximum number of parallel tasks</span></span>
    initialParallelTasks<span style="color: #990000">:</span> <span style="color: #993399">100</span>                         <span style="font-style: italic"><span style="color: #9A1900"># Maximum number of tasks at start</span></span>
    app<span style="color: #990000">.</span>ALL <span style="color: #990000">{</span> executable<span style="color: #990000">:</span> <span style="color: #FF0000">"*"</span> <span style="color: #990000">}</span>                       <span style="font-style: italic"><span style="color: #9A1900"># All tasks to be found from commandline</span></span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="paragraph"><p>Note: To ensure that the site you have selected is used by swift for the workflow, update the "sites: [&lt;SITE_NAME&gt;&#8230;]"
with "sites: [midway]".</p></div>
<div class="paragraph"><p>There are detailed instructions for each of the sites in the <a href="#remote-configuration">Remote site configuration</a> section.</p></div>
<div class="sect2">
<h3 id="_example_4_running_a_simple_app_on_remote_node">Example 4: Running a simple app on remote node</h3>
<div class="paragraph"><p>In <code>p4.swift</code>, there is a simple <code>app</code> which takes a file containing random numbers and <code>sort</code> them before returning a sorted output. In the <code>part04</code>
folder we have a file, <code>unsorted.txt</code>, which contains 100 random integers ranging from 0 to 99 and we wish to run the job on a remote computational resource.
Ensure that you have configured the <code>swift.conf</code> for your target remote site.</p></div>
<div class="listingblock">
<div class="title">p4.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">sortdata</span></span> <span style="color: #990000">(</span>file unsorted<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
    sort <span style="color: #FF0000">"-n"</span> <span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>unsorted<span style="color: #990000">)</span> stdout<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">filename</span></span><span style="color: #990000">(</span>out<span style="color: #990000">);</span>
<span style="color: #990000">}</span>

file unsorted <span style="color: #990000">&lt;</span><span style="color: #FF0000">"unsorted.txt"</span><span style="color: #990000">&gt;;</span>
file sorted   <span style="color: #990000">&lt;</span><span style="color: #FF0000">"sorted.txt"</span><span style="color: #990000">&gt;;</span>

sorted <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">sortdata</span></span><span style="color: #990000">(</span>unsorted<span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>We rely on the common <code>sort</code> command line utility in this example. When a remote site is set as the execution target,
Swift will connect to it and start swift-workers which in turn will execute tasks, in this case <code>sort</code>. Swift handles the
staging or moving of the necessary input and output files between the target systems and the machine you are running Swift on.</p></div>
<div class="paragraph"><p>Once Swift completes execution, you should see a new <code>sorted.txt</code> file in the folder containing numerically sorted
results.</p></div>
<div class="paragraph"><p>For example, to run the job remotely on Midway and to view the output:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">04</span>
$ swift p4<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">09</span><span style="color: #990000">:</span><span style="color: #993399">43</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">09</span><span style="color: #990000">:</span><span style="color: #993399">44</span>-<span style="color: #993399">0600</span>  Submitting<span style="color: #990000">:</span><span style="color: #993399">1</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">09</span><span style="color: #990000">:</span><span style="color: #993399">59</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">1</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">10</span><span style="color: #990000">:</span><span style="color: #993399">06</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">10</span><span style="color: #990000">:</span><span style="color: #993399">07</span>-<span style="color: #993399">0600</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>
Final status<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">10</span><span style="color: #990000">:</span><span style="color: #993399">14</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">1</span>

$ more unsorted<span style="color: #990000">.</span>txt
<span style="color: #993399">7</span>
<span style="color: #993399">49</span>
<span style="color: #993399">73</span>
<span style="color: #993399">58</span>
<span style="color: #993399">30</span>
<span style="color: #993399">72</span>
<span style="color: #990000">...</span>

$ more sorted<span style="color: #990000">.</span>txt
<span style="color: #993399">1</span>
<span style="color: #993399">2</span>
<span style="color: #993399">3</span>
<span style="color: #993399">4</span>
<span style="color: #993399">5</span>
<span style="color: #990000">...</span>
</tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important" />
</td>
<td class="content">Once the Swift status shows the jobs to be "Submitted", the time
to completion of jobs can vary based on how busy the queues are on the target resource.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">The <a href="#remote-configuration">Remote configuration</a> section explains how to check
the status of your jobs in the queue for systems with PBS, Condor or Slurm schedulers.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_example_5_running_a_parallel_ensemble_on_compute_resources">Example 5: Running a parallel ensemble on compute resources</h3>
<div class="paragraph"><p><code>p5.swift</code> will run our mock "simulation" applications on compute nodes.  The
script is similar to <code>p3.swift</code>, but specifies that each simulation app
invocation should additionally return the log file which the application writes
to <code>stderr</code>. In <code>p3.swift</code> the apps simulation and stats called the binaries
stats and simulate which are available on the local machine and is present in
the system path. The <code>p5.swift</code> script</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">,</span> file log<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">(</span>int sim_steps<span style="color: #990000">,</span> int sim_range<span style="color: #990000">,</span> int sim_values<span style="color: #990000">,</span> file sim_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @sim_script <span style="color: #FF0000">"--timesteps"</span> sim_steps <span style="color: #FF0000">"--range"</span> sim_range <span style="color: #FF0000">"--nvalues"</span> sim_values stdout<span style="color: #990000">=</span>@out stderr<span style="color: #990000">=</span>@log<span style="color: #990000">;</span>
<span style="color: #990000">}</span></tt></pre></div></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="part05.png" alt="part05.png" />
</div>
</div>
<div class="listingblock">
<div class="title">p5.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">,</span> file log<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">(</span>int sim_steps<span style="color: #990000">,</span> int sim_range<span style="color: #990000">,</span> int sim_values<span style="color: #990000">,</span> file sim_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @sim_script <span style="color: #FF0000">"--timesteps"</span> sim_steps <span style="color: #FF0000">"--range"</span> sim_range <span style="color: #FF0000">"--nvalues"</span> sim_values stdout<span style="color: #990000">=</span>@out stderr<span style="color: #990000">=</span>@log<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">,</span> file log<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span> <span style="color: #990000">(</span>file s<span style="color: #990000">[],</span> file stat_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @stat_script <span style="font-weight: bold"><span style="color: #000000">filenames</span></span><span style="color: #990000">(</span>s<span style="color: #990000">)</span> stdout<span style="color: #990000">=</span>@out stderr<span style="color: #990000">=</span>@log<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

int nsim   <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"nsim"</span><span style="color: #990000">,</span>   <span style="color: #FF0000">"10"</span><span style="color: #990000">));</span>
int steps  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"steps"</span><span style="color: #990000">,</span>  <span style="color: #FF0000">"1"</span><span style="color: #990000">));</span>
int range  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"range"</span><span style="color: #990000">,</span>  <span style="color: #FF0000">"100"</span><span style="color: #990000">));</span>
int values <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"values"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"5"</span><span style="color: #990000">));</span>

file sims<span style="color: #990000">[];</span>
file simulate_script <span style="color: #990000">&lt;</span><span style="color: #FF0000">"simulate.sh"</span><span style="color: #990000">&gt;;</span>
file stats_script <span style="color: #990000">&lt;</span><span style="color: #FF0000">"stats.sh"</span><span style="color: #990000">&gt;;</span>

foreach i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">:</span>nsim<span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">]</span> <span style="color: #990000">{</span>
  file simout <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".out"</span><span style="color: #990000">)&gt;;</span>
  file simlog <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".log"</span><span style="color: #990000">)&gt;;</span>
  <span style="color: #990000">(</span>simout<span style="color: #990000">,</span>simlog<span style="color: #990000">)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">(</span>steps<span style="color: #990000">,</span>range<span style="color: #990000">,</span>values<span style="color: #990000">,</span>simulate_script<span style="color: #990000">);</span>
  sims<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> simout<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

file stats_out<span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/average.out"</span><span style="color: #990000">&gt;;</span>
file stats_log<span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/average.log"</span><span style="color: #990000">&gt;;</span>
<span style="color: #990000">(</span>stats_out<span style="color: #990000">,</span> stats_log<span style="color: #990000">)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span><span style="color: #990000">(</span>sims<span style="color: #990000">,</span>stats_script<span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>To run:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">05</span>
$ swift p5<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">01</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">02</span>-<span style="color: #993399">0600</span>  Submitting<span style="color: #990000">:</span><span style="color: #993399">10</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">16</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">10</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">24</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">6</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">45</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">3</span>  Active<span style="color: #990000">:</span><span style="color: #993399">2</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">46</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">2</span>  Active<span style="color: #990000">:</span><span style="color: #993399">3</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">15</span><span style="color: #990000">:</span><span style="color: #993399">47</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">2</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">07</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">3</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">7</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">08</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">2</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">7</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">21</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">2</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">8</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">28</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">10</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">29</span>-<span style="color: #993399">0600</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">10</span>
Final status<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">51</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">11</span>

<span style="font-style: italic"><span style="color: #9A1900"># Open the output/average.log to take a look at the rich set of machine specific</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># information collected from the target system.</span></span>
$ more output/average<span style="color: #990000">.</span>log
Start time<span style="color: #990000">:</span> Thu Jan <span style="color: #993399">22</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">16</span><span style="color: #990000">:</span><span style="color: #993399">29</span> CST <span style="color: #993399">2015</span>
Running as user<span style="color: #990000">:</span> <span style="color: #009900">uid</span><span style="color: #990000">=</span><span style="color: #993399">6040</span><span style="color: #990000">(</span>yadunandb<span style="color: #990000">)</span> <span style="color: #009900">gid</span><span style="color: #990000">=</span><span style="color: #993399">1000</span><span style="color: #990000">(</span>ci-users<span style="color: #990000">)</span> <span style="color: #009900">groups</span><span style="color: #990000">=</span><span style="color: #993399">1000</span><span style="color: #990000">(</span>ci-users<span style="color: #990000">),</span><span style="color: #993399">1033</span><span style="color: #990000">(</span>vdl2-svn<span style="color: #990000">),</span><span style="color: #993399">1082</span><span style="color: #990000">(</span>CI-CCR<span style="color: #993399">000013</span><span style="color: #990000">),</span><span style="color: #993399">1094</span><span style="color: #990000">(</span>CI-SES<span style="color: #993399">000031</span><span style="color: #990000">),</span><span style="color: #993399">1120</span><span style="color: #990000">(</span>CI-IBN<span style="color: #993399">000050</span><span style="color: #990000">)</span>
Running on node<span style="color: #990000">:</span> nid00116
<span style="color: #990000">...</span>
</tt></pre></div></div>
<div class="sect3">
<h4 id="_performing_larger_swift_runs">Performing larger Swift runs</h4>
<div class="paragraph"><p>To test with larger runs, there are two changes that are required. The first is
a change to the command line arguments. The example below will run 1000
simulations with each simulation taking 5 seconds.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># You can increase maxJobs or tasksPerNode to increase the resources available to Swift</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># With the default swift.conf, the following will be processed 4 tasks at a time :</span></span>
$ swift p5<span style="color: #990000">.</span>swift -steps<span style="color: #990000">=</span><span style="color: #993399">5</span> -nsim<span style="color: #990000">=</span><span style="color: #993399">100</span>
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">35</span><span style="color: #990000">:</span><span style="color: #993399">01</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">35</span><span style="color: #990000">:</span><span style="color: #993399">02</span>-<span style="color: #993399">0600</span>  Submitting<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">35</span><span style="color: #990000">:</span><span style="color: #993399">16</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">35</span><span style="color: #990000">:</span><span style="color: #993399">27</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">96</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">35</span><span style="color: #990000">:</span><span style="color: #993399">52</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">92</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">36</span><span style="color: #990000">:</span><span style="color: #993399">17</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">92</span>  Active<span style="color: #990000">:</span><span style="color: #993399">3</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">36</span><span style="color: #990000">:</span><span style="color: #993399">18</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">88</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">8</span>
<span style="color: #990000">...</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">46</span><span style="color: #990000">:</span><span style="color: #993399">27</span>-<span style="color: #993399">0600</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">99</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">46</span><span style="color: #990000">:</span><span style="color: #993399">40</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">46</span><span style="color: #990000">:</span><span style="color: #993399">53</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">100</span>
Final status<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">46</span><span style="color: #990000">:</span><span style="color: #993399">53</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">101</span>

<span style="font-style: italic"><span style="color: #9A1900"># From the time-stamps it can be seen that run001 took ~12minutes, with only 4 jobs active at</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># any given time</span></span>

<span style="font-style: italic"><span style="color: #9A1900"># The following run was done with swift.conf modified to use higher tasksPerNode and maxJobs</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># maxJobs       : 2      # Increased from 1</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># tasksPerNode  : 15     # Increased from 4</span></span>
$ swift p5<span style="color: #990000">.</span>swift -steps<span style="color: #990000">=</span><span style="color: #993399">5</span> -nsim<span style="color: #990000">=</span><span style="color: #993399">100</span>
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run002
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">35</span>-<span style="color: #993399">0600</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">36</span>-<span style="color: #993399">0600</span>  Submitting<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">49</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">04</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">85</span>  Active<span style="color: #990000">:</span><span style="color: #993399">15</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">05</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">8</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">77</span>  Active<span style="color: #990000">:</span><span style="color: #993399">15</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">06</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">70</span>  Active<span style="color: #990000">:</span><span style="color: #993399">30</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">30</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">55</span>  Active<span style="color: #990000">:</span><span style="color: #993399">30</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">15</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">31</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">53</span>  Active<span style="color: #990000">:</span><span style="color: #993399">29</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">17</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">32</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">40</span>  Active<span style="color: #990000">:</span><span style="color: #993399">29</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">30</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">31</span><span style="color: #990000">:</span><span style="color: #993399">33</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">40</span>  Active<span style="color: #990000">:</span><span style="color: #993399">30</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">30</span>
<span style="color: #990000">...</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span><span style="color: #993399">23</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">17</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">82</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span><span style="color: #993399">24</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">10</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">90</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span><span style="color: #993399">47</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">6</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">93</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span><span style="color: #993399">48</span>-<span style="color: #993399">0600</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">99</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span><span style="color: #993399">49</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">100</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">33</span><span style="color: #990000">:</span><span style="color: #993399">02</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">100</span>
Final status<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">33</span><span style="color: #990000">:</span><span style="color: #993399">02</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">101</span></tt></pre></div></div>
</div>
</div>
<div class="sect2">
<h3 id="_example_6_specifying_more_complex_workflow_patterns">Example 6: Specifying more complex workflow patterns</h3>
<div class="paragraph"><p>p6.swift expands the workflow pattern of p5.swift to add additional
stages to the workflow. Here, we generate a dynamic seed value that
will be used by all of the simulations, and for each simulation, we
run a pre-processing application to generate a unique "bias
file". This pattern is shown below, followed by the Swift script.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="part06.png" alt="part06.png" />
</div>
</div>
<div class="listingblock">
<div class="title">p6.swift</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>type file<span style="color: #990000">;</span>

<span style="font-style: italic"><span style="color: #9A1900"># app() functions for application programs to be called:</span></span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">genseed</span></span> <span style="color: #990000">(</span>int nseeds<span style="color: #990000">,</span> file seed_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @seed_script <span style="color: #FF0000">"-r"</span> <span style="color: #993399">2000000</span> <span style="color: #FF0000">"-n"</span> nseeds stdout<span style="color: #990000">=</span>@out<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">genbias</span></span> <span style="color: #990000">(</span>int bias_range<span style="color: #990000">,</span> int nvalues<span style="color: #990000">,</span> file bias_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @bias_script <span style="color: #FF0000">"-r"</span> bias_range <span style="color: #FF0000">"-n"</span> nvalues stdout<span style="color: #990000">=</span>@out<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">,</span> file log<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span> <span style="color: #990000">(</span>int timesteps<span style="color: #990000">,</span> int sim_range<span style="color: #990000">,</span>
                                     file bias_file<span style="color: #990000">,</span> int scale<span style="color: #990000">,</span> int sim_count<span style="color: #990000">,</span>
                                     file sim_script<span style="color: #990000">,</span> file seed_file<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @sim_script <span style="color: #FF0000">"-t"</span> timesteps <span style="color: #FF0000">"-r"</span> sim_range <span style="color: #FF0000">"-B"</span> @bias_file <span style="color: #FF0000">"-x"</span> scale
           <span style="color: #FF0000">"-n"</span> sim_count <span style="color: #FF0000">"-S"</span> @seed_file stdout<span style="color: #990000">=</span>@out stderr<span style="color: #990000">=</span>@log<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

<span style="font-weight: bold"><span style="color: #000000">app</span></span> <span style="color: #990000">(</span>file out<span style="color: #990000">,</span> file log<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span> <span style="color: #990000">(</span>file s<span style="color: #990000">[],</span> file stat_script<span style="color: #990000">)</span>
<span style="color: #990000">{</span>
  bash @stat_script <span style="font-weight: bold"><span style="color: #000000">filenames</span></span><span style="color: #990000">(</span>s<span style="color: #990000">)</span> stdout<span style="color: #990000">=</span>@out stderr<span style="color: #990000">=</span>@log<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

<span style="font-style: italic"><span style="color: #9A1900"># Command line arguments</span></span>

int  nsim  <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"nsim"</span><span style="color: #990000">,</span>   <span style="color: #FF0000">"10"</span><span style="color: #990000">));</span>  <span style="font-style: italic"><span style="color: #9A1900"># number of simulation programs to run</span></span>
int  steps <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"steps"</span><span style="color: #990000">,</span>  <span style="color: #FF0000">"1"</span><span style="color: #990000">));</span>   <span style="font-style: italic"><span style="color: #9A1900"># number of timesteps (seconds) per simulation</span></span>
int  range <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"range"</span><span style="color: #990000">,</span>  <span style="color: #FF0000">"100"</span><span style="color: #990000">));</span> <span style="font-style: italic"><span style="color: #9A1900"># range of the generated random numbers</span></span>
int  values <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">toInt</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">arg</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"values"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"10"</span><span style="color: #990000">));</span>  <span style="font-style: italic"><span style="color: #9A1900"># number of values generated per simulation</span></span>

<span style="font-style: italic"><span style="color: #9A1900"># Main script and data</span></span>

file simulate_script <span style="color: #990000">&lt;</span><span style="color: #FF0000">"simulate.sh"</span><span style="color: #990000">&gt;;</span>
file stats_script <span style="color: #990000">&lt;</span><span style="color: #FF0000">"stats.sh"</span><span style="color: #990000">&gt;;</span>
file seedfile <span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/seed.dat"</span><span style="color: #990000">&gt;;</span>        <span style="font-style: italic"><span style="color: #9A1900"># Dynamically generated bias for simulation ensemble</span></span>

<span style="font-weight: bold"><span style="color: #000000">tracef</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"\n*** Script parameters: nsim=%i range=%i num values=%i\n\n"</span><span style="color: #990000">,</span> nsim<span style="color: #990000">,</span> range<span style="color: #990000">,</span> values<span style="color: #990000">);</span>
seedfile <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">genseed</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span>simulate_script<span style="color: #990000">);</span>

file sims<span style="color: #990000">[];</span>                      <span style="font-style: italic"><span style="color: #9A1900"># Array of files to hold each simulation output</span></span>

foreach i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">:</span>nsim<span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">]</span> <span style="color: #990000">{</span>
  file biasfile <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/bias_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".dat"</span><span style="color: #990000">)&gt;;</span>
  file simout   <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".out"</span><span style="color: #990000">)&gt;;</span>
  file simlog   <span style="color: #990000">&lt;</span>single_file_mapper<span style="color: #990000">;</span> file<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">strcat</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"output/sim_"</span><span style="color: #990000">,</span>i<span style="color: #990000">,</span><span style="color: #FF0000">".log"</span><span style="color: #990000">)&gt;;</span>
  biasfile <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">genbias</span></span><span style="color: #990000">(</span><span style="color: #993399">1000</span><span style="color: #990000">,</span> <span style="color: #993399">20</span><span style="color: #990000">,</span> simulate_script<span style="color: #990000">);</span>
  <span style="color: #990000">(</span>simout<span style="color: #990000">,</span>simlog<span style="color: #990000">)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">(</span>steps<span style="color: #990000">,</span> range<span style="color: #990000">,</span> biasfile<span style="color: #990000">,</span> <span style="color: #993399">1000000</span><span style="color: #990000">,</span> values<span style="color: #990000">,</span> simulate_script<span style="color: #990000">,</span> seedfile<span style="color: #990000">);</span>
  sims<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> simout<span style="color: #990000">;</span>
<span style="color: #990000">}</span>

file stats_out<span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/average.out"</span><span style="color: #990000">&gt;;</span>
file stats_log<span style="color: #990000">&lt;</span><span style="color: #FF0000">"output/average.log"</span><span style="color: #990000">&gt;;</span>
<span style="color: #990000">(</span>stats_out<span style="color: #990000">,</span>stats_log<span style="color: #990000">)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">analyze</span></span><span style="color: #990000">(</span>sims<span style="color: #990000">,</span> stats_script<span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>Note that the workflow is based on data flow dependencies: each simulation depends on the seed value, calculated in this statement:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>seedfile <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">genseed</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>and on the bias file, computed and then consumed in these two dependent statements:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>  biasfile <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">genbias</span></span><span style="color: #990000">(</span><span style="color: #993399">1000</span><span style="color: #990000">,</span> <span style="color: #993399">20</span><span style="color: #990000">,</span> simulate_script<span style="color: #990000">);</span>
  <span style="color: #990000">(</span>simout<span style="color: #990000">,</span>simlog<span style="color: #990000">)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">simulation</span></span><span style="color: #990000">(</span>steps<span style="color: #990000">,</span> range<span style="color: #990000">,</span> biasfile<span style="color: #990000">,</span> <span style="color: #993399">1000000</span><span style="color: #990000">,</span> values<span style="color: #990000">,</span> simulate_script<span style="color: #990000">,</span> seedfile<span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>To run:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ cd swift-tutorial/part<span style="color: #993399">06</span>
$ swift p6<span style="color: #990000">.</span>swift
Swift <span style="color: #993399">0.96</span>
RunID<span style="color: #990000">:</span> run001
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">54</span><span style="color: #990000">:</span><span style="color: #993399">47</span>-<span style="color: #993399">0600</span>

<span style="color: #990000">***</span> Script parameters<span style="color: #990000">:</span> <span style="color: #009900">nsim</span><span style="color: #990000">=</span><span style="color: #993399">10</span> <span style="color: #009900">range</span><span style="color: #990000">=</span><span style="color: #993399">100</span> num <span style="color: #009900">values</span><span style="color: #990000">=</span><span style="color: #993399">10</span>

Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">54</span><span style="color: #990000">:</span><span style="color: #993399">48</span>-<span style="color: #993399">0600</span>  Submitting<span style="color: #990000">:</span><span style="color: #993399">11</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">01</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">11</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">08</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">3</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">8</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">09</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">7</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">29</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">4</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">3</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">32</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">3</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">4</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">49</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">3</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">6</span>  Active<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">7</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">50</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">6</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">7</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">55</span><span style="color: #990000">:</span><span style="color: #993399">52</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">6</span>  Active<span style="color: #990000">:</span><span style="color: #993399">3</span>  Stage out<span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">7</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">56</span><span style="color: #990000">:</span><span style="color: #993399">10</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">6</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">11</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">56</span><span style="color: #990000">:</span><span style="color: #993399">31</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">2</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">4</span>  Active<span style="color: #990000">:</span><span style="color: #993399">2</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">13</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">56</span><span style="color: #990000">:</span><span style="color: #993399">32</span>-<span style="color: #993399">0600</span>  Submitted<span style="color: #990000">:</span><span style="color: #993399">2</span>  Active<span style="color: #990000">:</span><span style="color: #993399">4</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">15</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">56</span><span style="color: #990000">:</span><span style="color: #993399">53</span>-<span style="color: #993399">0600</span>  Active<span style="color: #990000">:</span><span style="color: #993399">2</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">19</span>
Progress<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">57</span><span style="color: #990000">:</span><span style="color: #993399">14</span>-<span style="color: #993399">0600</span>  Stage <span style="font-weight: bold"><span style="color: #0000FF">in</span></span><span style="color: #990000">:</span><span style="color: #993399">1</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">21</span>
Final status<span style="color: #990000">:</span> Thu<span style="color: #990000">,</span> <span style="color: #993399">22</span> Jan <span style="color: #993399">2015</span> <span style="color: #993399">17</span><span style="color: #990000">:</span><span style="color: #993399">57</span><span style="color: #990000">:</span><span style="color: #993399">16</span>-<span style="color: #993399">0600</span>  Finished successfully<span style="color: #990000">:</span><span style="color: #993399">22</span>

<span style="font-style: italic"><span style="color: #9A1900"># which produces the following output:</span></span>
$ ls output<span style="color: #990000">/</span>
average<span style="color: #990000">.</span>log  bias_1<span style="color: #990000">.</span>dat  bias_4<span style="color: #990000">.</span>dat  bias_7<span style="color: #990000">.</span>dat  seed<span style="color: #990000">.</span>dat   sim_1<span style="color: #990000">.</span>log  sim_2<span style="color: #990000">.</span>out  sim_4<span style="color: #990000">.</span>log  sim_5<span style="color: #990000">.</span>out  sim_7<span style="color: #990000">.</span>log  sim_8<span style="color: #990000">.</span>out
average<span style="color: #990000">.</span>out  bias_2<span style="color: #990000">.</span>dat  bias_5<span style="color: #990000">.</span>dat  bias_8<span style="color: #990000">.</span>dat  sim_0<span style="color: #990000">.</span>log  sim_1<span style="color: #990000">.</span>out  sim_3<span style="color: #990000">.</span>log  sim_4<span style="color: #990000">.</span>out  sim_6<span style="color: #990000">.</span>log  sim_7<span style="color: #990000">.</span>out  sim_9<span style="color: #990000">.</span>log
bias_0<span style="color: #990000">.</span>dat   bias_3<span style="color: #990000">.</span>dat  bias_6<span style="color: #990000">.</span>dat  bias_9<span style="color: #990000">.</span>dat  sim_0<span style="color: #990000">.</span>out  sim_2<span style="color: #990000">.</span>log  sim_3<span style="color: #990000">.</span>out  sim_5<span style="color: #990000">.</span>log  sim_6<span style="color: #990000">.</span>out  sim_8<span style="color: #990000">.</span>log  sim_9<span style="color: #990000">.</span>out

<span style="font-style: italic"><span style="color: #9A1900"># Each sim_N.out file is the sum of its bias file plus newly "simulated" random output scaled by 1,000,000:</span></span>

$ cat output/bias_0<span style="color: #990000">.</span>dat
     <span style="color: #993399">302</span>
     <span style="color: #993399">489</span>
      <span style="color: #993399">81</span>
     <span style="color: #993399">582</span>
     <span style="color: #993399">664</span>
     <span style="color: #993399">290</span>
     <span style="color: #993399">839</span>
     <span style="color: #993399">258</span>
     <span style="color: #993399">506</span>
     <span style="color: #993399">310</span>
     <span style="color: #993399">293</span>
     <span style="color: #993399">508</span>
      <span style="color: #993399">88</span>
     <span style="color: #993399">261</span>
     <span style="color: #993399">453</span>
     <span style="color: #993399">187</span>
      <span style="color: #993399">26</span>
     <span style="color: #993399">198</span>
     <span style="color: #993399">402</span>
     <span style="color: #993399">555</span>

$ cat output/sim_0<span style="color: #990000">.</span>out
<span style="color: #993399">64000302</span>
<span style="color: #993399">38000489</span>
<span style="color: #993399">32000081</span>
<span style="color: #993399">12000582</span>
<span style="color: #993399">46000664</span>
<span style="color: #993399">36000290</span>
<span style="color: #993399">35000839</span>
<span style="color: #993399">22000258</span>
<span style="color: #993399">49000506</span>
<span style="color: #993399">75000310</span></tt></pre></div></div>
<div class="paragraph"><p>We produce 20 values in each bias file. Simulations of less than that
number of values ignore the unneeded number, while simualtions of more
than 20 will use the last bias number for all remaining values past
20.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">As an exercise, adjust the code to produce the same number of bias values as is needed for each simulation.  As a further exercise, modify the script to generate a unique seed value for each simulation, which is a common practice in ensemble computations.</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_information_and_references">Additional information and references</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_mock_science_applications_used_in_the_workflow_tutorial">Mock "science applications" used in the workflow tutorial</h3>
<div class="paragraph"><p>This tutorial is based on two trivial example programs,
<code>simulate.sh</code> and <code>stats.sh</code>, (implemented as bash shell scripts)
that serve as easy-to-understand proxies for real science
applications. These "programs" behave as follows.</p></div>
<div class="sect3">
<h4 id="_simulate_sh">simulate.sh</h4>
<div class="paragraph"><p>The simulation.sh script serves as a trivial proxy for any more
complex scientific simulation application. It generates and prints a
set of one or more random integers in the range [0-2^62) as controlled
by its command line arguments, which are:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ <span style="color: #990000">.</span>/app/simulate<span style="color: #990000">.</span>sh --help
<span style="color: #990000">.</span>/app/simulate<span style="color: #990000">.</span>sh<span style="color: #990000">:</span> usage<span style="color: #990000">:</span>
    -b<span style="color: #990000">|</span>--bias       offset bias<span style="color: #990000">:</span> add this integer to all results <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">]</span>
    -B<span style="color: #990000">|</span>--biasfile   file of integer biases to add to results <span style="color: #990000">[</span>none<span style="color: #990000">]</span>
    -l<span style="color: #990000">|</span>--log        generate a log <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> stderr <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> not null <span style="color: #990000">[</span>y<span style="color: #990000">]</span>
    -n<span style="color: #990000">|</span>--nvalues    print this many values per simulation <span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span>
    -r<span style="color: #990000">|</span>--range      range <span style="color: #990000">(</span>limit<span style="color: #990000">)</span> of generated results <span style="color: #990000">[</span><span style="color: #993399">100</span><span style="color: #990000">]</span>
    -s<span style="color: #990000">|</span>--seed       use this integer <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">..</span><span style="color: #993399">32767</span><span style="color: #990000">]</span> as a seed <span style="color: #990000">[</span>none<span style="color: #990000">]</span>
    -S<span style="color: #990000">|</span>--seedfile   use this file <span style="color: #990000">(</span>containing integer seeds <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">..</span><span style="color: #993399">32767</span><span style="color: #990000">])</span> one per line <span style="color: #990000">[</span>none<span style="color: #990000">]</span>
    -t<span style="color: #990000">|</span>--timesteps  number of simulated <span style="color: #FF0000">"timesteps"</span> <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> seconds <span style="color: #990000">(</span>determines runtime<span style="color: #990000">)</span> <span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span>
    -x<span style="color: #990000">|</span>--scale      scale the results by this integer <span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span>
    -h<span style="color: #990000">|</span>-<span style="color: #990000">?|?|</span>--help  print this <span style="font-weight: bold"><span style="color: #0000FF">help</span></span>
$</tt></pre></div></div>
<div class="paragraph"><p>All of these arguments are optional, with default values indicated above as <code>[n]</code>.</p></div>
<div class="paragraph"><p>With no arguments, simulate.sh prints 1 number in the range of
1-100. Otherwise it generates n numbers of the form (R*scale)+bias
where R is a random integer. By default it logs information about its
execution environment to stderr.  Here is some examples of its usage:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ simulate<span style="color: #990000">.</span>sh <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
       <span style="color: #993399">5</span>
$ head -<span style="color: #993399">4</span> log

Called as<span style="color: #990000">:</span> /home/wilde/swift/tut/CIC_2013-<span style="color: #993399">08</span>-<span style="color: #993399">09</span>/app/simulate<span style="color: #990000">.</span>sh<span style="color: #990000">:</span>
Start time<span style="color: #990000">:</span> Thu Aug <span style="color: #993399">22</span> <span style="color: #993399">12</span><span style="color: #990000">:</span><span style="color: #993399">40</span><span style="color: #990000">:</span><span style="color: #993399">24</span> CDT <span style="color: #993399">2013</span>
Running on node<span style="color: #990000">:</span> login01<span style="color: #990000">.</span>osgconnect<span style="color: #990000">.</span>net

$ simulate<span style="color: #990000">.</span>sh -n <span style="color: #993399">4</span> -r <span style="color: #993399">1000000</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
  <span style="color: #993399">239454</span>
  <span style="color: #993399">386702</span>
   <span style="color: #993399">13849</span>
  <span style="color: #993399">873526</span>

$ simulate<span style="color: #990000">.</span>sh -n <span style="color: #993399">3</span> -r <span style="color: #993399">1000000</span> -x <span style="color: #993399">100</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
 <span style="color: #993399">6643700</span>
<span style="color: #993399">62182300</span>
 <span style="color: #993399">5230600</span>

$ simulate<span style="color: #990000">.</span>sh -n <span style="color: #993399">2</span> -r <span style="color: #993399">1000</span> -x <span style="color: #993399">1000</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
  <span style="color: #993399">565000</span>
  <span style="color: #993399">636000</span>

$ time simulate<span style="color: #990000">.</span>sh -n <span style="color: #993399">2</span> -r <span style="color: #993399">1000</span> -x <span style="color: #993399">1000</span> -t <span style="color: #993399">3</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
  <span style="color: #993399">336000</span>
  <span style="color: #993399">320000</span>
real    0m3<span style="color: #990000">.</span>012s
user    0m0<span style="color: #990000">.</span>005s
sys     0m0<span style="color: #990000">.</span>006s</tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_stats_sh">stats.sh</h4>
<div class="paragraph"><p>The stats.sh script serves as a trivial model of an "analysis"
program. It reads N files each containing M integers and simply prints
the average of all those numbers to stdout. Similar to simulate.sh
it logs environmental information to the stderr.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$ ls f<span style="color: #990000">*</span>
f1  f2  f3  f4

$ cat f<span style="color: #990000">*</span>
<span style="color: #993399">25</span>
<span style="color: #993399">60</span>
<span style="color: #993399">40</span>
<span style="color: #993399">75</span>

$ stats<span style="color: #990000">.</span>sh f<span style="color: #990000">*</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;</span>log
<span style="color: #993399">50</span></tt></pre></div></div>
</div>
</div>
<div class="sect2">
<h3 id="_a_summary_of_swift_in_a_nutshell">A Summary of Swift in a nutshell</h3>
<div class="ulist"><ul>
<li>
<p>
Swift scripts are text files ending in <code>.swift</code> The <code>swift</code> command
runs on any host, and executes these scripts. <code>swift</code> is a Java
application, which you can install almost anywhere.  On Linux, just
unpack the distribution <code>tar</code> file and add its <code>bin/</code> directory to
your <code>PATH</code>.
</p>
</li>
<li>
<p>
Swift scripts run ordinary applications, just like shell scripts
do. Swift makes it easy to run these applications on parallel and
remote computers (from laptops to supercomputers). If you can <code>ssh</code> to
the system, Swift can likely run applications there.
</p>
</li>
<li>
<p>
The details of where to run applications and how to get files back
and forth are described in configuration files separate from your
program. Swift speaks ssh, PBS, Condor, SLURM, LSF, SGE, Cobalt, and
Globus to run applications, and scp, http, ftp, and GridFTP to move
data.
</p>
</li>
<li>
<p>
The Swift language has 5 main data types: <code>boolean</code>, <code>int</code>,
<code>string</code>, <code>float</code>, and <code>file</code>. Collections of these are dynamic,
sparse arrays of arbitrary dimension and structures of scalars and/or
arrays defined by the <code>type</code> declaration.
</p>
</li>
<li>
<p>
Swift file variables are "mapped" to external files. Swift sends
files to and from remote systems for you automatically.
</p>
</li>
<li>
<p>
Swift variables are "single assignment": once you set them you can not change
them (in a given block of code).  This makes Swift a natural, "parallel data
flow" language. This programming model keeps your workflow scripts simple and
easy to write and understand.
</p>
</li>
<li>
<p>
Swift lets you define functions to "wrap" application programs, and
to cleanly structure more complex scripts. Swift <code>app</code> functions take
files and parameters as inputs and return files as outputs.
</p>
</li>
<li>
<p>
A compact set of built-in functions for string and file
manipulation, type conversions, high level IO, etc. is provided.
Swift&#8217;s equivalent of <code>printf()</code> is <code>tracef()</code>, with limited and
slightly different format codes.
</p>
</li>
<li>
<p>
Swift&#8217;s parallel <code>foreach {}</code> statement is the workhorse of the
language, and executes all iterations of the loop concurrently. The
actual number of parallel tasks executed is based on available
resources and settable "throttles".
</p>
</li>
<li>
<p>
Swift conceptually executes <strong>all</strong> the statements,
expressions and function calls in your program in parallel, based on
data flow. These are similarly throttled based on available resources
and settings.
</p>
</li>
<li>
<p>
Swift also has <code>if</code> and <code>switch</code> statements for conditional
execution. These are seldom needed in simple workflows but they enable
very dynamic workflow patterns to be specified.
</p>
</li>
</ul></div>
<div class="paragraph"><p>We will see many of these points in action in the examples below. Lets
get started!</p></div>
</div>
<div class="sect2">
<h3 id="remote-configuration">Remote site configuration</h3>
<div class="paragraph"><p>Part04 onwards, the tutorial is designed to run on remote computational resources.
The following sections outline the steps required to enable swift to run tasks remotely.</p></div>
<div class="paragraph"><p>Setting up ssh-keys for password-less acccess : <a href="http://hortonworks.com/kb/generating-ssh-keys-for-passwordless-login/">How-to-passwordless-login</a></p></div>
<div class="sect3">
<h4 id="_midway_cluster_at_uchicago">Midway cluster at UChicago</h4>
<div class="paragraph"><p>The Midway cluster is a shared computational resource administered by the Research
Computing Center at the University of Chicago. Here&#8217;s documentation on the RCC resources:
<a href="https://rcc.uchicago.edu/docs/">RCC docs</a></p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial on the Midway cluster:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Midway login nodes.
</p>
</li>
<li>
<p>
If you are running on the midway login nodes you set jobManager: "local:slurm"
</p>
</li>
<li>
<p>
Set workDirectory to /tmp/your_username_on_midway
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>midway<span style="color: #990000">]</span></tt></pre></div></div>
<div class="paragraph"><p>Notes:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># The following commands are to be executed on the Midway login node</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># Check your account and balance</span></span>
accounts balance

<span style="font-style: italic"><span style="color: #9A1900"># List queues</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_beagle_supercomputer_cray">Beagle Supercomputer (Cray)</h4>
<div class="paragraph"><p>The Beagle supercomputer is a Cray XE6 system at the Computation Institute.
Here is documentation on Beagle: <a href="http://beagle.ci.uchicago.edu/using-beagle/">Beagle docs</a></p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial on the Beagle supercomputer:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Beagle login nodes.
</p>
</li>
<li>
<p>
If you are running on the beagle login nodes, set jobManager: "local:pbs"
</p>
</li>
<li>
<p>
Find your project name/allocation and set jobProject : "YOUR_PROJECT_ON_BEAGLE"
</p>
</li>
<li>
<p>
Set userHomeOverride : "/lustre/beagle2/YOUR_USERNAME_ON_BEAGLE/swiftwork"
</p>
</li>
<li>
<p>
Set workDirectory : "/tmp/YOUR_USERNAME_ON_BEAGLE/swiftwork"
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>beagle<span style="color: #990000">]</span></tt></pre></div></div>
</li>
</ol></div>
<div class="paragraph"><p>Notes for beagle:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># The following commands should be executed on a beagle login node</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># To check your allocation and project on Beagle:</span></span>
show_alloc

<span style="font-style: italic"><span style="color: #9A1900"># List queues</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span>

<span style="font-style: italic"><span style="color: #9A1900"># Visual representation of current node allocation status</span></span>
xtnodestat -d</tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_blues_cluster_at_lcrc">Blues cluster at LCRC</h4>
<div class="paragraph"><p>Blues is a compute cluster at the Laboratory Computing Resource Center (LCRC) at Argonne National Laboratory.
The blues cluster features 310 nodes, with 16 cores per node (Intel Sandybridge).
Here&#8217;s documentation on Blues: <a href="http://www.lcrc.anl.gov/info/Blues">Blues docs</a></p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial on the Blues cluster</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Blues login nodes (blues.lcrc.anl.gov).
</p>
</li>
<li>
<p>
If you are ru    nning on the blues login nodes, set jobManager: "local:pbs"
</p>
</li>
<li>
<p>
Set workDirectory : "/home/YOUR_USERNAME_ON_BLUES/swiftwork"
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>blues<span style="color: #990000">]</span></tt></pre></div></div>
</li>
</ol></div>
<div class="paragraph"><p>Notes for blues:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># The following commands should be executed on a beagle login node</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># List queues</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_osgconnect_at_uchicago">OSGConnect at UChicago</h4>
<div class="paragraph"><p>The Open Science Grid (OSG) and University of Chicago provides a service to access a vast
pool of opportunistic computational resources spread across the U.S. Here&#8217;s documentation on the OSG Connect resources:
<a href="https://confluence.grid.iu.edu/display/CON/Home">OSGConnect docs</a>.</p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial via OSGConnect on the Open Science Grid:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enable ssh keys for passwordless access to the OSGConnect login nodes.
</p>
</li>
<li>
<p>
If you are running on the OSGConnect login node set jobManager: "local:condor"
</p>
</li>
<li>
<p>
Set projectname : "YOUR_PROJECTNAME_ON_OSG"
</p>
</li>
<li>
<p>
Set workDirectory : "/tmp/YOUR_USERNAME_ON_OSG"
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file:
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>osgc<span style="color: #990000">]</span></tt></pre></div></div>
</li>
</ol></div>
<div class="paragraph"><p>Notes for OSGConnect :</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># The following commands should be executed on the OSGConnect login node</span></span>
<span style="font-style: italic"><span style="color: #9A1900"># To check/select your project on OSGConnect</span></span>
connect project

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
condor_q <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_amazon_ec2">Amazon EC2</h4>
<div class="paragraph"><p>Amazon Elastic Compute Cloud (Amazon EC2) is a web service that provides resizable compute capacity in the cloud.
Getting cloud resources on-demand from Amazon is now as simple as setting up an account and attaching a credit card.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Follow steps outlined in <a href="./amazon_ec2.html">Amazon docs</a> to set up an account and install local dependencies.
</p>
</li>
<li>
<p>
Set ec2CredentialsFile: "ABSOLUTE_PATH_TO_YOUR_AWS_CREDENTIALS_FILE"
</p>
</li>
<li>
<p>
Ensure that ec2KeypairFile points to a valid path
</p>
</li>
<li>
<p>
If you update ec2WorkerImage, ensure that it is a ubuntu image
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file:
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>aws<span style="color: #990000">]</span></tt></pre></div></div>
</li>
</ol></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">If you kill a swift-run before completion, Swift would not be able to terminate your instances. This can
lead to instances continuing to run and costing you money. Please ensure that all swift-worker instances have
terminated by logging into the <a href="https://us-west-2.console.aws.amazon.com/ec2/v2/home?region=us-west-2#Home:">EC2 dashboard</a>
once you&#8217;ve completed the tutorial.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_collection_of_ad_hoc_nodes">Collection of Ad-Hoc Nodes</h4>
<div class="paragraph"><p>Using this configuration scheme swift allows you to use multiple independent nodes as a pool of resources.
Assume that you have access to N machines ( ad-hoc-1.foo.net, ad-hoc-2.foo.net &#8230; ad-hoc-N.foo.net )
You can replicate the site.ad-hoc-1 site definition block for each site you have access to, and swift
will run tasks on all of them.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enable ssh keys for passwordless access to the each of the ad-hoc Nodes.
</p>
</li>
<li>
<p>
Replicate the site block for each ad-hoc node
</p>
</li>
<li>
<p>
For each site block, set URL : URL_OF_AD_HOC_MACHINE_N
</p>
</li>
<li>
<p>
Set workDirectory : "/tmp/USERNAME_ON_AD-HOC-N/work"
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[&lt;</span>ad-hoc-<span style="color: #993399">1</span><span style="color: #990000">.</span>foo<span style="color: #990000">.</span>net<span style="color: #990000">&gt;,</span> <span style="color: #990000">&lt;</span>ad-hoc-<span style="color: #993399">1</span><span style="color: #990000">.</span>foo<span style="color: #990000">.</span>net<span style="color: #990000">&gt;,</span> <span style="color: #990000">...</span> <span style="color: #990000">&lt;</span>ad-hoc-N<span style="color: #990000">.</span>foo<span style="color: #990000">.</span>net<span style="color: #990000">&gt;]</span></tt></pre></div></div>
</li>
</ol></div>
</div>
<div class="sect3">
<h4 id="_multiple_sites">Multiple sites</h4>
<div class="paragraph"><p>Swift allows you to run you applications on multiple sites that you have access to.
Let&#8217;s say you would like to run you applications on Midway and Beagle.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enable ssh keys for passwordless access to the both Midway and Beagle
</p>
</li>
<li>
<p>
Set the site specific variables for both sites in the swift-tutorial/setup.sh file.
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file:
</p>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>midway<span style="color: #990000">,</span> beagle<span style="color: #990000">]</span></tt></pre></div></div>
</li>
</ol></div>
</div>
<div class="sect3">
<h4 id="_tacc_stampede_xsede">TACC Stampede(XSEDE)</h4>
<div class="paragraph"><p>The TACC Stampede* system is a 10 PFLOPS (PF) Dell Linux Cluster based on 6400+ Dell
PowerEdge server nodes, each outfitted with 2 Intel Xeon E5 (Sandy Bridge) processors
and an Intel Xeon Phi Coprocessor (MIC Architecture). Here&#8217;s a great reference for stampede:
<a href="https://portal.tacc.utexas.edu/user-guides/stampede">Stampede User Guide</a></p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial on Stampede:</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">The preferred way to run the tutorial is from the stampede login nodes rather than from
a remote system.</td>
</tr></table>
</div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Stampede login nodes (Only necessary if running from remote)
</p>
</li>
<li>
<p>
If you are running on login&lt;ID&gt;.stampede.tacc.utexas.edu, you set jobManager: "local:slurm"
</p>
</li>
<li>
<p>
Set workDirectory to /tmp/your_username_on_stampede
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>stampede<span style="color: #990000">]</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">The network between Stampede and UChicago is unusually slow, avoid network traffic if possible.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Stampede uses Lustre parallel shared filesystem. The environment variables $HOME, $WORK, $SCRATCH
point at different Lustre filesystems all of which are accessible from the login and compute nodes.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">There&#8217;s a limit of one job per user on the development queue ( maxJobs=1)</td>
</tr></table>
</div>
<div class="paragraph"><p>Notes:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># List queues and status</span></span>
sinfo -o <span style="color: #FF0000">"%20P %5a %.10l %16F"</span>

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
showq -u <span style="color: #009900">$USER</span>

<span style="font-style: italic"><span style="color: #9A1900"># Interactive shell for debugging:</span></span>
srun -p development -t <span style="color: #993399">0</span><span style="color: #990000">:</span><span style="color: #993399">30</span><span style="color: #990000">:</span><span style="color: #993399">00</span> -n <span style="color: #993399">32</span> --pty /bin/bash -l</tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_blacklight_psc_xsede">Blacklight PSC (XSEDE)</h4>
<div class="paragraph"><p>Blacklight is an SGI UV 1000cc-NUMA shared-memory system comprising 256 blades. Each blade
holds 2 Intel Xeon X7560 (Nehalem) eight-core processors, for a total of 4096 cores across
the whole machine. Here&#8217;s documentation for Blacklight:
<a href="https://http://www.psc.edu/index.php/computing-resources/blacklight">Blacklight User Guide</a></p></div>
<div class="paragraph"><p>Here are the steps to run the tutorial on Blacklight:</p></div>
<div class="paragraph"><p>The preferred way to run the tutorial is from the Blacklight login nodes rather than from
a remote system.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Blacklight login nodes (Only necessary if running from remote)
</p>
</li>
<li>
<p>
If you are running on the login nodes, set jobManager: "local:pbs"
</p>
</li>
<li>
<p>
Set workDirectory to /tmp/your_username_on_blacklight
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>blacklight<span style="color: #990000">]</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Blacklight has $WORK, $HOME mounted on a shared filesystem.</td>
</tr></table>
</div>
<div class="paragraph"><p>Notes:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># List queues and status</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_gordon_sdsc_xsede">Gordon SDSC (XSEDE)</h4>
<div class="paragraph"><p>Gordon is a dedicated XSEDE cluster designed by Appro and SDSC consisting of 1024 compute nodes and 64 I/O nodes.
Here is some additional documentation on Gordon:
<a href="http://www.sdsc.edu/us/resources/gordon/">Gordon User Guide</a></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The swift client cannot run on the gordon login nodes due to memory limits on the machine. Swift must
be run from a remote location.</td>
</tr></table>
</div>
<div class="paragraph"><p>Here are the steps to run the tutorial on Gordon:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Gordon login nodes
</p>
</li>
<li>
<p>
Set workDirectory to /tmp/your_username_on_blacklight
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>gordon<span style="color: #990000">]</span></tt></pre></div></div>
<div class="paragraph"><p>Notes:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># List queues and status</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
<div class="sect3">
<h4 id="_trestles_sdsc_xsede">Trestles SDSC (XSEDE)</h4>
<div class="paragraph"><p>Trestles is a dedicated XSEDE cluster designed by Appro and SDSC consisting
of 324 compute nodes. Each compute node contains four sockets, each with an 8-core
2.4 GHz AMD Magny-Cours processor, for a total of 32 cores per node and 10,368 total cores for the system.
. Here&#8217;s documentation for Trestles:
<a href="http://www.sdsc.edu/us/resources/trestles/">Trestles User Guide</a></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The swift client cannot run on the gordon login nodes due to memory limits on the machine. Swift must
be run from a remote location.</td>
</tr></table>
</div>
<div class="paragraph"><p>Here are the steps to run the tutorial on Trestles:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Ensure you have enabled ssh keys for passwordless access to the Trestles.
</p>
</li>
<li>
<p>
Set workDirectory to /tmp/your_username_on_blacklight
</p>
</li>
<li>
<p>
Set the following line in the swift-tutorial/swift.conf file.
</p>
</li>
</ol></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>   sites<span style="color: #990000">:</span> <span style="color: #990000">[</span>trestles<span style="color: #990000">]</span></tt></pre></div></div>
<div class="paragraph"><p>Notes:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.6
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900"># List queues and status</span></span>
qstat -q

<span style="font-style: italic"><span style="color: #9A1900"># List your jobs and state</span></span>
qstat -u <span style="color: #009900">$USER</span></tt></pre></div></div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2015-01-29 15:58:24 CST
</div>
</div>
</body>
</html>
